ras_a3 <- ras_a3[order(ras_a3$tracking_id),]
ras_b3 <- read.delim("/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/FPKM20140408/genes.fpkm_tracking_ras_b3.txt", header=TRUE, sep="\t")
ras_b3 <- ras_b3[order(ras_b3$tracking_id),]
ras_a20 <- read.delim("/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/FPKM20140408/genes.fpkm_tracking_ras_a20.txt", header=TRUE, sep="\t")
ras_a20 <- ras_a20[order(ras_a20$tracking_id),]
ras_b20 <- read.delim("/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/FPKM20140408/genes.fpkm_tracking_ras_b20.txt", header=TRUE, sep="\t")
ras_b20 <- ras_b20[order(ras_b20$tracking_id),]
FPKM_table <- cbind(p_a3$FPKM,p_b3$FPKM,p_a20$FPKM,p_b20$FPKM,
h_a3$FPKM,h_b3$FPKM,h_a20$FPKM,h_b20$FPKM,
sv_a3$FPKM,sv_b3$FPKM,sv_a20$FPKM,sv_b20$FPKM,
ras_a3$FPKM,ras_b3$FPKM,ras_a20$FPKM,ras_b20$FPKM)
rownames(FPKM_table) <- as.character(p_a3$tracking_id)
colnames(FPKM_table) <- c("prim_a3","prim_b3","prim_a20","prim_b20",
"htert_a3","htert_b3","htert_a20","htert_b20",
"sv_a3","sv_b3","sv_a20","sv_b20",
"ras_a3","ras_b3","ras_a20","ras_b20")
gene_ids <- rownames(FPKM_table)
ensembl = useMart("ensembl", dataset = "hsapiens_gene_ensembl") #select the ensembl database
gene_type <- getBM(attributes=c("ensembl_gene_id", "gene_biotype"),
filters = "ensembl_gene_id",
values=gene_ids,
mart=ensembl)
pc <- subset(gene_type[,1],gene_type[,2]=="protein_coding")
FPKM_pc <- FPKM_table[pc,]
FPKM_pc_nozero <- FPKM_pc[-which(rowSums(FPKM_pc[,])<=1),]
dim(FPKM_pc_nozero)
rm(list = ls(all = TRUE))
library(biomaRt)
library(limma)
library(VennDiagram)
library(DESeq2)
library(SPIA)
library(clValid)
library(gplots)
directory<-"/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/COUNTS/"
PrimFiles <- grep("count_prim",list.files(directory),value=TRUE)
Prim3Files <- grep("count_prim3",list.files(directory),value=TRUE)
Prim20Files <- grep("count_prim20",list.files(directory),value=TRUE)
HtertFiles <- grep("count_htert",list.files(directory),value=TRUE)
Htert3Files <- grep("count_htert3",list.files(directory),value=TRUE)
Htert20Files <- grep("count_htert20",list.files(directory),value=TRUE)
SvFiles <- grep("count_sv",list.files(directory),value=TRUE)
Sv3Files <- grep("count_sv3",list.files(directory),value=TRUE)
Sv20Files <- grep("count_sv20",list.files(directory),value=TRUE)
RasFiles <- grep("count_ras",list.files(directory),value=TRUE)
Ras3Files <- grep("count_ras3",list.files(directory),value=TRUE)
Ras20Files <- grep("count_ras20",list.files(directory),value=TRUE)
#Comparison between models
sampleCondition <-c("high","high","low","low")
sampleTable_prim <- data.frame(sampleName=PrimFiles, fileName=PrimFiles, condition=sampleCondition)
sampleTable_htert <- data.frame(sampleName=HtertFiles, fileName=HtertFiles, condition=sampleCondition)
sampleTable_sv <- data.frame(sampleName=SvFiles, fileName=SvFiles, condition=sampleCondition)
sampleTable_ras <- data.frame(sampleName=RasFiles, fileName=RasFiles, condition=sampleCondition)
ddsHTSeq_prim <- DESeqDataSetFromHTSeqCount(sampleTable=sampleTable_prim, directory=directory, design=~condition)
ddsHTSeq_htert <- DESeqDataSetFromHTSeqCount(sampleTable=sampleTable_htert, directory=directory, design=~condition)
ddsHTSeq_sv <- DESeqDataSetFromHTSeqCount(sampleTable=sampleTable_sv, directory=directory, design=~condition)
ddsHTSeq_ras <- DESeqDataSetFromHTSeqCount(sampleTable=sampleTable_ras, directory=directory, design=~condition)
dds_prim <- DESeq(ddsHTSeq_prim)
dds_htert <- DESeq(ddsHTSeq_htert)
dds_sv <- DESeq(ddsHTSeq_sv)
dds_ras <- DESeq(ddsHTSeq_ras)
res_prim <- results(dds_prim)
res_htert <- results(dds_htert)
res_sv <- results(dds_sv)
res_ras <- results(dds_ras)
#ta ut signifikanta gener (DE)
prim_sign <- na.omit(subset(res_prim,res_prim$padj<=0.01))
htert_sign <- na.omit(subset(res_htert,res_htert$padj<=0.01))
sv_sign <- na.omit(subset(res_sv,res_sv$padj<=0.01))
ras_sign <- na.omit(subset(res_ras,res_ras$padj<=0.01))
ensembl = useMart("ensembl", dataset= "hsapiens_gene_ensembl")
prim_sign_type <- getBM(attributes=c("ensembl_gene_id","gene_biotype"),
filters = "ensembl_gene_id",
values = rownames(prim_sign),
mart = ensembl)
htert_sign_type <- getBM(attributes=c("ensembl_gene_id","gene_biotype"),
filters = "ensembl_gene_id",
values = rownames(htert_sign),
mart = ensembl)
sv_sign_type <- getBM(attributes=c("ensembl_gene_id","gene_biotype"),
filters = "ensembl_gene_id",
values = rownames(sv_sign),
mart = ensembl)
ras_sign_type <- getBM(attributes=c("ensembl_gene_id","gene_biotype"),
filters = "ensembl_gene_id",
values = rownames(ras_sign),
mart = ensembl)
prim_sign_pc <- na.omit(prim_sign[subset(prim_sign_type[,1],prim_sign_type[,2]=="protein_coding"),])
htert_sign_pc <- na.omit(htert_sign[subset(htert_sign_type[,1],htert_sign_type[,2]=="protein_coding"),])
sv_sign_pc <- na.omit(sv_sign[subset(sv_sign_type[,1],sv_sign_type[,2]=="protein_coding"),])
ras_sign_pc <- na.omit(ras_sign[subset(ras_sign_type[,1],ras_sign_type[,2]=="protein_coding"),])
DE_3vs20 <- unique(c(rownames(prim_sign_pc),
rownames(htert_sign_pc),
rownames(sv_sign_pc),
rownames(ras_sign_pc)))
ensembl = useMart("ensembl", dataset= "hsapiens_gene_ensembl")
DE_3vs20_names <- getBM(attributes=c("ensembl_gene_id","hgnc_symbol"),
filters = "ensembl_gene_id",
values = DE_3vs20,
mart = ensembl)
?merge
head(DE_3vs20)
#lÃ¤ser in FPKM-vÃ¤rden:
prim_a3 <- read.table("/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/FPKM20140408/genes.fpkm_tracking_prim_a3.txt",header=T, sep="\t")
prim_b3 <- read.table("/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/FPKM20140408/genes.fpkm_tracking_prim_b3.txt",header=T, sep="\t")
prim_a20 <- read.table("/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/FPKM20140408/genes.fpkm_tracking_prim_a20.txt",header=T, sep="\t")
prim_b20 <- read.table("/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/FPKM20140408/genes.fpkm_tracking_prim_b20.txt",header=T, sep="\t")
htert_a3 <- read.table("/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/FPKM20140408/genes.fpkm_tracking_htert_a3.txt",header=T, sep="\t")
htert_b3 <- read.table("/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/FPKM20140408/genes.fpkm_tracking_htert_b3.txt",header=T, sep="\t")
htert_a20 <- read.table("/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/FPKM20140408/genes.fpkm_tracking_htert_a20.txt",header=T, sep="\t")
htert_b20 <- read.table("/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/FPKM20140408/genes.fpkm_tracking_htert_b20.txt",header=T, sep="\t")
sv_a3 <- read.table("/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/FPKM20140408/genes.fpkm_tracking_sv_a3.txt",header=T, sep="\t")
sv_a20 <- read.table("/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/FPKM20140408/genes.fpkm_tracking_sv_a20.txt",header=T, sep="\t")
sv_b3 <- read.table("/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/FPKM20140408/genes.fpkm_tracking_sv_b3.txt",header=T, sep="\t")
sv_b20 <- read.table("/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/FPKM20140408/genes.fpkm_tracking_sv_b20.txt",header=T, sep="\t")
ras_a3 <- read.table("/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/FPKM20140408/genes.fpkm_tracking_ras_a3.txt",header=T, sep="\t")
ras_a20 <- read.table("/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/FPKM20140408/genes.fpkm_tracking_ras_a20.txt",header=T, sep="\t")
ras_b3 <- read.table("/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/FPKM20140408/genes.fpkm_tracking_ras_b3.txt",header=T, sep="\t")
ras_b20 <- read.table("/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/FPKM20140408/genes.fpkm_tracking_ras_b20.txt",header=T, sep="\t")
fpkm_all <-      cbind(rowMeans(cbind(prim_a3[order(prim_a3$tracking_id),10],prim_b3[order(prim_b3$tracking_id),10])),
rowMeans(cbind(htert_a3[order(htert_a3$tracking_id),10],htert_b3[order(htert_b3$tracking_id),10])),
rowMeans(cbind(sv_a3[order(sv_a3$tracking_id),10],sv_b3[order(sv_b3$tracking_id),10])),
rowMeans(cbind(ras_a3[order(ras_a3$tracking_id),10],ras_b3[order(ras_b3$tracking_id),10])),
rowMeans(cbind(prim_a20[order(prim_a20$tracking_id),10],prim_b20[order(prim_b20$tracking_id),10])),
rowMeans(cbind(htert_a20[order(htert_a20$tracking_id),10],htert_b20[order(htert_b20$tracking_id),10])),
rowMeans(cbind(sv_a20[order(sv_a20$tracking_id),10],sv_b20[order(sv_b20$tracking_id),10])),
rowMeans(cbind(ras_a20[order(ras_a20$tracking_id),10],ras_b20[order(ras_b20$tracking_id),10]))
)
colnames(fpkm_all) <- c("prim_3","htert_3","sv_3","ras_3",
"prim_20","htert_20","sv_20","ras_20")
rownames(fpkm_all) <- as.vector(prim_a3[order(prim_a3$tracking_id),1])
fpkm_DE_3vs20 <- fpkm_all[DE_3vs20,]
head(DE_3vs20)
head(fpkm_DE_3vs20)
fpkm_DE_3vs20 <- cbind(fpkm_all[DE_3vs20,],DE_3vs20_names)
write.table(fpkm_DE_3vs20,"/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/DESEQ2/SPIA/fpkm_DE_3vs20.txt", sep="\t")
DE_3vs20_symbs <- DE_3vs20_names[,2]
names(DE_3vs20_symbs) <- DE_3vs20_names[,1]
fpkm_DE_3vs20 <- cbind(fpkm_all[names(DE_3vs20_symbs),],DE_3vs20_symbs)
head(fpkm_DE_3vs20)
write.table(fpkm_DE_3vs20,"/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/DESEQ2/SPIA/fpkm_DE_3vs20.txt", sep="\t")
fpkm_DE_3vs20 <- cbind(fpkm_all[DE_3vs20_names[,1],],DE_3vs20_names[,])
head(fpkm_DE_3vs20)
write.table(fpkm_DE_3vs20,"/Users/fridadanielsson/Documents/Projekt/BJ/HYPOXIA/DESEQ2/SPIA/fpkm_DE_3vs20.txt", sep="\t")
rm(list = ls(all = TRUE))
library("ggplot2")
#download data that is not merged:
directory <- "/Users/fridadanielsson/Documents/Projekt/Publika_dataset/manuscript/reickemergadeidn"
filenames <- list.files(directory, pattern="*.txt", full.names=TRUE)
list_of_data = lapply(filenames, read.table,
sep = "\t",header=T)
AltIso_all <- list_of_data[[1]]
atlas_all <- list_of_data[[2]]
gtex_all <- list_of_data[[3]]
HPA_all <- list_of_data[[4]]
head(list_of_data)
head(names(list_of_data))
head(rownames(list_of_data))
all_altIso_heart <- data.frame(AltIso_all$AltIso_heart)
colnames(all_altIso_heart) <- "FPKM"
all_altIso_heart$study <- "altIso"
head(all_altIso_heart)
head(all_altIso_heart)
head(AltIso_all)
str(list_of_data)
head(levels(list_of_data))
head(AltIso_all)
ensembl = useMart("ensembl", dataset= "hsapiens_gene_ensembl")
ensembl = useMart("ensembl", dataset= "hsapiens_gene_ensembl")
AltIso_type <- getBM(attributes=c("ensembl_gene_id","gene_biotype"),
filters = "ensembl_gene_id",
values = AltIso_all$ENSG_ID,
mart = ensembl)
head(AltIso_type)
table(AltIso_type[,2])
head(AltIso_all)
head(AltIso_type)
atlas_type <- getBM(attributes=c("ensembl_gene_id","gene_biotype"),
filters = "ensembl_gene_id",
values = atlas_all$ENSG_ID,
mart = ensembl)
gtex_type <- getBM(attributes=c("ensembl_gene_id","gene_biotype"),
filters = "ensembl_gene_id",
values = gtex_all$ENSG_ID,
mart = ensembl)
HPA_type <- getBM(attributes=c("ensembl_gene_id","gene_biotype"),
filters = "ensembl_gene_id",
values = HPA_all$ENSG_ID,
mart = ensembl)
head(HPA_type)
AltIso_pc <- AltIso_all[which(AltIso_type[,2]=="protein_coding"),]
table(AltIso_type)
table(AltIso_type[,2])
atlas_pc <- atlas_all[which(atlas_type[,2]=="protein_coding"),]
gtex_pc <- gtex[which(gtex_type[,2]=="protein_coding"),]
gtex_pc <- gtex_all[which(gtex_type[,2]=="protein_coding"),]
HPA_pc <- HPA_all[which(HPA_type[,2]=="protein_coding"),]
head(HPA_pc)
all_altIso_heart <- data.frame(AltIso_pc$AltIso_heart)
colnames(all_altIso_heart) <- "FPKM"
all_altIso_heart$study <- "altIso"
#heart:
all_altIso_heart <- data.frame(AltIso_pc$AltIso_heart)
colnames(all_altIso_heart) <- "FPKM"
all_altIso_heart$study <- "altIso"
all_atlas_heart <- data.frame(atlas_pc$Atlas_heart)
colnames(all_atlas_heart) <- "FPKM"
all_atlas_heart$study <- "atlas"
all_gtex_heart <- data.frame(gtex_pc$GTEx_heart)
colnames(all_gtex_heart) <- "FPKM"
all_gtex_heart$study <- "gtex"
all_HPA_heart <- data.frame(HPA_pc$HPA_heart)
colnames(all_HPA_heart) <- "FPKM"
all_HPA_heart$study <- "HPA"
#brain:
all_altIso_brain <- data.frame(AltIso_pc$AltIso_brain)
colnames(all_altIso_brain) <- "FPKM"
all_altIso_brain$study <- "altIso"
all_atlas_brain <- data.frame(atlas_pc$Atlas_brain)
colnames(all_atlas_brain) <- "FPKM"
all_atlas_brain$study <- "atlas"
all_gtex_brain <- data.frame(gtex_pc$GTEx_brain)
colnames(all_gtex_brain) <- "FPKM"
all_gtex_brain$study <- "gtex"
all_HPA_brain <- data.frame(HPA_pc$HPA_brain)
colnames(all_HPA_brain) <- "FPKM"
all_HPA_brain$study <- "HPA"
#kidney:
all_atlas_kid <- data.frame(atlas_pc$Atlas_kid)
colnames(all_atlas_kid) <- "FPKM"
all_atlas_kid$study <- "atlas"
all_gtex_kid <- data.frame(gtex_pc$GTEx_kid)
colnames(all_gtex_kid) <- "FPKM"
all_gtex_kid$study <- "gtex"
all_HPA_kid <- data.frame(HPA_pc$HPA_kid)
colnames(all_HPA_kid) <- "FPKM"
all_HPA_kid$study <- "HPA"
#brain:
merg_altIso_brain <- data.frame(merged_data$AltIso_brain)
colnames(merg_altIso_brain) <- "FPKM"
merg_altIso_brain$study <- "altIso merged"
merg_atlas_brain <- data.frame(merged_data$Atlas_brain)
colnames(merg_atlas_brain) <- "FPKM"
merg_atlas_brain$study <- "atlas merged"
merg_gtex_brain <- data.frame(merged_data$GTEx_brain)
colnames(merg_gtex_brain) <- "FPKM"
merg_gtex_brain$study <- "gtex merged"
merged_data <- read.table("/Users/fridadanielsson/Documents/Projekt/Publika_dataset/manuscript/revision/published_rpkms.txt",sep=" ")
#brain:
merg_altIso_brain <- data.frame(merged_data$AltIso_brain)
colnames(merg_altIso_brain) <- "FPKM"
merg_altIso_brain$study <- "altIso merged"
merg_atlas_brain <- data.frame(merged_data$Atlas_brain)
colnames(merg_atlas_brain) <- "FPKM"
merg_atlas_brain$study <- "atlas merged"
merg_gtex_brain <- data.frame(merged_data$GTEx_brain)
colnames(merg_gtex_brain) <- "FPKM"
merg_gtex_brain$study <- "gtex merged"
merg_HPA_brain <- data.frame(merged_data$HPA_brain)
colnames(merg_HPA_brain) <- "FPKM"
merg_HPA_brain$study <- "HPA merged"
#heart:
merg_altIso_heart <- data.frame(merged_data$AltIso_heart)
colnames(merg_altIso_heart) <- "FPKM"
merg_altIso_heart$study <- "altIso merged"
merg_atlas_heart <- data.frame(merged_data$Atlas_heart)
colnames(merg_atlas_heart) <- "FPKM"
merg_atlas_heart$study <- "atlas merged"
merg_gtex_heart <- data.frame(merged_data$GTEx_heart)
colnames(merg_gtex_heart) <- "FPKM"
merg_gtex_heart$study <- "gtex merged"
merg_HPA_heart <- data.frame(merged_data$HPA_heart)
colnames(merg_HPA_heart) <- "FPKM"
merg_HPA_heart$study <- "HPA merged"
#kidney:
merg_atlas_kid <- data.frame(merged_data$Atlas_kid)
colnames(merg_atlas_kid) <- "FPKM"
merg_atlas_kid$study <- "atlas merged"
merg_gtex_kid <- data.frame(merged_data$GTEx_kid)
colnames(merg_gtex_kid) <- "FPKM"
merg_gtex_kid$study <- "gtex merged"
merg_HPA_kid <- data.frame(merged_data$HPA_kid)
colnames(merg_HPA_kid) <- "FPKM"
merg_HPA_kid$study <- "HPA merged"
all_altiso <- rbind(all_altIso_brain,all_altIso_heart)
all_atlas <- rbind(all_atlas_brain,all_atlas_heart,all_atlas_kid)
all_gtex <- rbind(all_gtex_brain,all_gtex_heart,all_gtex_kid)
all_hpa <- rbind(all_HPA_brain,all_HPA_heart,all_HPA_kid)
all_data <- rbind(all_altiso,all_atlas,all_gtex,all_hpa)
ggplot(all_data, aes(log2(FPKM+1), colour = study)) + geom_density(alpha = 0.2) + xlim(0, 7) + theme_bw()
merg_altiso <- rbind(merg_altIso_brain,merg_altIso_heart)
merg_atlas <- rbind(merg_atlas_brain,merg_atlas_heart,merg_atlas_kid)
merg_gtex <- rbind(merg_gtex_brain,merg_gtex_heart,merg_gtex_kid)
merg_hpa <- rbind(merg_HPA_brain,merg_HPA_heart,merg_HPA_kid)
merg_data <- rbind(merg_altiso,merg_atlas,merg_gtex,merg_hpa)
ggplot(merg_data, aes(log2(FPKM+1), colour = study)) + geom_density(alpha = 0.2) + xlim(0,7) + theme_bw()
all_brain_data <- rbind(all_altIso_brain,all_atlas_brain,all_gtex_brain,all_HPA_brain)
merg_brain_data <- rbind(merg_altIso_brain,merg_atlas_brain,merg_gtex_brain,merg_HPA_brain)
ggplot(merg_brain_data, aes(log2(FPKM+1), colour = study)) + geom_density(alpha = 0.2) + xlim(0, 7) + theme_bw()
ggplot(all_brain_data, aes(log2(FPKM+1), colour = study)) + geom_density(alpha = 0.2) + xlim(0, 7) + theme_bw()
ggplot(rbind(merg_brain_data,all_brain_data), aes(log2(FPKM+1), colour = study)) + geom_density(alpha = 0.2) + xlim(0, 7) + theme_bw()
rm(list = ls(all = TRUE))
library("ggplot2")
#download data that is not merged:
directory <- "/Users/fridadanielsson/Documents/Projekt/Publika_dataset/manuscript/reickemergadeidn"
filenames <- list.files(directory, pattern="*.txt", full.names=TRUE)
list_of_data = lapply(filenames, read.table,
sep = "\t",header=T)
AltIso_all <- list_of_data[[1]]
atlas_all <- list_of_data[[2]]
gtex_all <- list_of_data[[3]]
HPA_all <- list_of_data[[4]]
#ta ut alla proteinkodande frÃ¥n de icke-mergade listorna:
ensembl = useMart("ensembl", dataset= "hsapiens_gene_ensembl")
AltIso_type <- getBM(attributes=c("ensembl_gene_id","gene_biotype"),
filters = "ensembl_gene_id",
values = AltIso_all$ENSG_ID,
mart = ensembl)
AltIso_pc <- AltIso_all[which(AltIso_type[,2]=="protein_coding"),]
atlas_type <- getBM(attributes=c("ensembl_gene_id","gene_biotype"),
filters = "ensembl_gene_id",
values = atlas_all$ENSG_ID,
mart = ensembl)
atlas_pc <- atlas_all[which(atlas_type[,2]=="protein_coding"),]
gtex_type <- getBM(attributes=c("ensembl_gene_id","gene_biotype"),
filters = "ensembl_gene_id",
values = gtex_all$ENSG_ID,
mart = ensembl)
gtex_pc <- gtex_all[which(gtex_type[,2]=="protein_coding"),]
HPA_type <- getBM(attributes=c("ensembl_gene_id","gene_biotype"),
filters = "ensembl_gene_id",
values = HPA_all$ENSG_ID,
mart = ensembl)
HPA_pc <- HPA_all[which(HPA_type[,2]=="protein_coding"),]
rm(list = ls(all = TRUE))
library("ggplot2")
#download data that is not merged:
directory <- "/Users/fridadanielsson/Documents/Projekt/Publika_dataset/manuscript/reickemergadeidn"
filenames <- list.files(directory, pattern="*.txt", full.names=TRUE)
list_of_data = lapply(filenames, read.table,
sep = "\t",header=T)
AltIso_all <- list_of_data[[1]]
atlas_all <- list_of_data[[2]]
gtex_all <- list_of_data[[3]]
HPA_all <- list_of_data[[4]]
library(pheatmap)
library(reshape)
library(gplots)
library(ops)
library(calibrate)
library(biomaRt)
library(sva)
published <- read.delim("published_rpkms.txt",sep=" ")
setwd("/Users/fridadanielsson/Documents/Projekt/Publika_dataset/manuscript/publicRNAseqdata")
published <- read.delim("published_rpkms.txt",sep=" ")
sampleinfo_published <- read.table("sample_info_published.txt",header=TRUE)
published.nozero <- published[-which(rowSums(published[,])<=0.01),]
pheatmap(cor(published.nozero, method="spearman"))
pheatmap(cor(published.nozero))
colors <- c("indianred", "dodgerblue", "forestgreen",
"indianred", "dodgerblue",
"indianred", "dodgerblue", "forestgreen",
"indianred", "dodgerblue", "forestgreen")
p <- prcomp(t(published.nozero))
shapes <- c(rep(15,3),rep(16,2),rep(17,3),rep(8,3))
plot(p$x[,1],p$x[,2],pch=shapes,cex=1.5,col=colors,xlab=paste("PC1 58% of variance"),ylab=paste("PC2 13% of variance"),main="Published FPKM/RPKM values \n n=13,323")
legend("bottomleft",legend=c("Heart","Brain","Kidney"),col=c("indianred", "dodgerblue", "forestgreen"),cex=1.5,pch=20)
legend("top",legend=c("HPA","AltIso","GTEx","Atlas"),col="black",pch=c(15,16,17,8),ncol=2)
library(pheatmap)
library(reshape)
library(gplots)
library(ops)
library(calibrate)
library(biomaRt)
library(sva)
published <- read.delim("published_rpkms.txt",sep=" ")
sampleinfo_published <- read.table("sample_info_published.txt",header=TRUE)
published.nozero <- published[-which(rowSums(published[,])<=0.01),]
pheatmap(cor(published.nozero, method="spearman"))
rm(list = ls(all = TRUE))
library("ggplot2")
atlas <- read.delim("atlas_fpkms.txt",sep=" ")
AltIso_all <- read.delim("altiso_fpkms.txt",sep=" ")
atlas <- read.delim("atlas_fpkms.txt",sep=" ")
atlas <- read.delim("atlas_fpkms.txt",sep=" ")
gtex_all <- read.delim("gtex_fpkms.txt",sep=" ")
HPA_all <- read.delim("hpa_fpkms.txt",sep=" ")
ensembl = useMart("ensembl", dataset= "hsapiens_gene_ensembl")
library(biomaRt)
library("ggplot2")
ensembl = useMart("ensembl", dataset= "hsapiens_gene_ensembl")
AltIso_all <- read.delim("altiso_fpkms.txt",sep=" ")
atlas_all <- read.delim("atlas_fpkms.txt",sep=" ")
gtex_all <- read.delim("gtex_fpkms.txt",sep=" ")
HPA_all <- read.delim("hpa_fpkms.txt",sep=" ")
ensembl = useMart("ensembl", dataset= "hsapiens_gene_ensembl")
head(AltIso_all)
AltIso_all <- read.delim("altiso_fpkms.txt",sep="\t")
head(AltIso_all)
atlas_all <- read.delim("atlas_fpkms.txt",sep="\t")
gtex_all <- read.delim("gtex_fpkms.txt",sep="\t")
HPA_all <- read.delim("hpa_fpkms.txt",sep="\t")
AltIso_type <- getBM(attributes=c("ensembl_gene_id","gene_biotype"),
filters = "ensembl_gene_id",
values = AltIso_all$ENSG_ID,
mart = ensembl)
AltIso_pc <- AltIso_all[which(AltIso_type[,2]=="protein_coding"),]
atlas_type <- getBM(attributes=c("ensembl_gene_id","gene_biotype"),
filters = "ensembl_gene_id",
values = atlas_all$ENSG_ID,
mart = ensembl)
atlas_pc <- atlas_all[which(atlas_type[,2]=="protein_coding"),]
gtex_type <- getBM(attributes=c("ensembl_gene_id","gene_biotype"),
filters = "ensembl_gene_id",
values = gtex_all$ENSG_ID,
mart = ensembl)
gtex_pc <- gtex_all[which(gtex_type[,2]=="protein_coding"),]
HPA_type <- getBM(attributes=c("ensembl_gene_id","gene_biotype"),
filters = "ensembl_gene_id",
values = HPA_all$ENSG_ID,
mart = ensembl)
HPA_pc <- HPA_all[which(HPA_type[,2]=="protein_coding"),]
published <- read.delim("published_rpkms.txt",sep=" ")
merged_data <- read.delim("published_rpkms.txt",sep=" ")
head(merged_data)
#-----------DATA BEFORE MERGE-----------
#heart:
all_altIso_heart <- data.frame(AltIso_pc$AltIso_heart)
colnames(all_altIso_heart) <- "FPKM"
all_altIso_heart$study <- "altIso"
all_atlas_heart <- data.frame(atlas_pc$Atlas_heart)
colnames(all_atlas_heart) <- "FPKM"
all_atlas_heart$study <- "atlas"
all_gtex_heart <- data.frame(gtex_pc$GTEx_heart)
colnames(all_gtex_heart) <- "FPKM"
all_gtex_heart$study <- "gtex"
all_HPA_heart <- data.frame(HPA_pc$HPA_heart)
colnames(all_HPA_heart) <- "FPKM"
all_HPA_heart$study <- "HPA"
#brain:
all_altIso_brain <- data.frame(AltIso_pc$AltIso_brain)
colnames(all_altIso_brain) <- "FPKM"
all_altIso_brain$study <- "altIso"
all_atlas_brain <- data.frame(atlas_pc$Atlas_brain)
colnames(all_atlas_brain) <- "FPKM"
all_atlas_brain$study <- "atlas"
all_gtex_brain <- data.frame(gtex_pc$GTEx_brain)
colnames(all_gtex_brain) <- "FPKM"
all_gtex_brain$study <- "gtex"
all_HPA_brain <- data.frame(HPA_pc$HPA_brain)
colnames(all_HPA_brain) <- "FPKM"
all_HPA_brain$study <- "HPA"
#kidney:
all_atlas_kid <- data.frame(atlas_pc$Atlas_kid)
colnames(all_atlas_kid) <- "FPKM"
all_atlas_kid$study <- "atlas"
all_gtex_kid <- data.frame(gtex_pc$GTEx_kid)
colnames(all_gtex_kid) <- "FPKM"
all_gtex_kid$study <- "gtex"
all_HPA_kid <- data.frame(HPA_pc$HPA_kid)
colnames(all_HPA_kid) <- "FPKM"
all_HPA_kid$study <- "HPA"
#-----------MERGED DATA-----------
#brain:
merg_altIso_brain <- data.frame(merged_data$AltIso_brain)
colnames(merg_altIso_brain) <- "FPKM"
merg_altIso_brain$study <- "altIso merged"
merg_atlas_brain <- data.frame(merged_data$Atlas_brain)
colnames(merg_atlas_brain) <- "FPKM"
merg_atlas_brain$study <- "atlas merged"
merg_gtex_brain <- data.frame(merged_data$GTEx_brain)
colnames(merg_gtex_brain) <- "FPKM"
merg_gtex_brain$study <- "gtex merged"
merg_HPA_brain <- data.frame(merged_data$HPA_brain)
colnames(merg_HPA_brain) <- "FPKM"
merg_HPA_brain$study <- "HPA merged"
#heart:
merg_altIso_heart <- data.frame(merged_data$AltIso_heart)
colnames(merg_altIso_heart) <- "FPKM"
merg_altIso_heart$study <- "altIso merged"
merg_atlas_heart <- data.frame(merged_data$Atlas_heart)
colnames(merg_atlas_heart) <- "FPKM"
merg_atlas_heart$study <- "atlas merged"
merg_gtex_heart <- data.frame(merged_data$GTEx_heart)
colnames(merg_gtex_heart) <- "FPKM"
merg_gtex_heart$study <- "gtex merged"
merg_HPA_heart <- data.frame(merged_data$HPA_heart)
colnames(merg_HPA_heart) <- "FPKM"
merg_HPA_heart$study <- "HPA merged"
#kidney:
merg_atlas_kid <- data.frame(merged_data$Atlas_kid)
colnames(merg_atlas_kid) <- "FPKM"
merg_atlas_kid$study <- "atlas merged"
merg_gtex_kid <- data.frame(merged_data$GTEx_kid)
colnames(merg_gtex_kid) <- "FPKM"
merg_gtex_kid$study <- "gtex merged"
merg_HPA_kid <- data.frame(merged_data$HPA_kid)
colnames(merg_HPA_kid) <- "FPKM"
merg_HPA_kid$study <- "HPA merged"
all_altiso <- rbind(all_altIso_brain,all_altIso_heart)
all_atlas <- rbind(all_atlas_brain,all_atlas_heart,all_atlas_kid)
all_gtex <- rbind(all_gtex_brain,all_gtex_heart,all_gtex_kid)
all_hpa <- rbind(all_HPA_brain,all_HPA_heart,all_HPA_kid)
all_data <- rbind(all_altiso,all_atlas,all_gtex,all_hpa)
ggplot(all_data, aes(log2(FPKM+1), colour = study)) + geom_density(alpha = 0.2) + xlim(0, 7) + theme_bw()
#skillnader mellan studier (alla tre vÃ¤vnader) efter merge:
merg_altiso <- rbind(merg_altIso_brain,merg_altIso_heart)
merg_atlas <- rbind(merg_atlas_brain,merg_atlas_heart,merg_atlas_kid)
merg_gtex <- rbind(merg_gtex_brain,merg_gtex_heart,merg_gtex_kid)
merg_hpa <- rbind(merg_HPA_brain,merg_HPA_heart,merg_HPA_kid)
merg_data <- rbind(merg_altiso,merg_atlas,merg_gtex,merg_hpa)
ggplot(merg_data, aes(log2(FPKM+1), colour = study)) + geom_density(alpha = 0.2) + xlim(0,7) + theme_bw()
